 void firehb()
 {
    location lFire = GetLocation(OBJECT_SELF);
    effect eFireDie = EffectVisualEffect(263,FALSE);
    object oFuel = GetFirstItemInInventory(OBJECT_SELF);
    int nLogCount;

    while(GetIsObjectValid(oFuel)){

            string sCurrentBurn = GetName(oFuel);

            SetLocalInt(oFuel,"nBurnCount",GetLocalInt(oFuel,"nBurnCount")+1);

                if(GetLocalInt(oFuel,"nBurnCount")>=2){
                    if(GetLocalInt(oFuel,"BurnedName")==TRUE){
                        string sOrigName = GetName(oFuel);
                        SetName(oFuel,"Charred "+sOrigName);
                        SetLocalInt(oFuel,"BurnedName",TRUE);
                        }
                    }

                if(GetLocalInt(oFuel,"nBurnCount")>=3 && GetTag(oFuel)=="fb_wood"){
                    nLogCount++;
                    SetLocalInt(OBJECT_SELF,"Fueled",GetLocalInt(OBJECT_SELF,"Fueled")+12);
                    DestroyObject(oFuel);
                    }

            oFuel = GetNextItemInInventory(OBJECT_SELF);
            }

    if(nLogCount==3){
        SpeakString("The logs within the well managed fire begin to burn in tandem.",TALKVOLUME_TALK);
        SetLocalInt(OBJECT_SELF,"Fueled",GetLocalInt(OBJECT_SELF,"Fueled")+9);
        }

        nLogCount = 0;

    if(GetLocalInt(OBJECT_SELF,"Fueled") >= 50){
        SpeakString("The fire rages. Adding any more wood would be dangerous.",TALKVOLUME_TALK);
        SetLocalInt(OBJECT_SELF,"Fueled",49);
        }

    if(GetLocalInt(OBJECT_SELF,"Fueled") ==3){
        SpeakString("The fire is quieting to a small flame.");
        }

    if(GetLocalInt(OBJECT_SELF,"Fueled") == 0){
        SpeakString("The final flames of the campfire fall to ember with a whisp of smoke",TALKVOLUME_TALK);
        ApplyEffectAtLocation(DURATION_TYPE_TEMPORARY,eFireDie,lFire,2.5);
        DestroyObject(OBJECT_SELF,1.0);
        }

    else {
        SetLocalInt(OBJECT_SELF,"Fueled",GetLocalInt(OBJECT_SELF,"Fueled")-1);
        SignalEvent(OBJECT_SELF,EventUserDefined(615881));
        }
 }


 void main()
{
    int nCall = GetUserDefinedEventNumber();

 switch (nCall)
    {
        case 615881:
        {
        DelayCommand(20.0,firehb());
        break;
        }
    }
}
